{
  "uid": "flink-jobs",
  "title": "Flink Jobs",
  "tags": ["flink"],
  "timezone": "browser",
  "schemaVersion": 38,
  "refresh": "15s",
  "time": {"from": "now-1h", "to": "now"},
  "panels": [
    {
      "id": 1,
      "title": "Records In / sec",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
      "targets": [
        {
          "expr": "flink_taskmanager_job_task_numRecordsInPerSecond",
          "legendFormat": "{{task_name}}"
        }
      ],
      "fieldConfig": {"defaults": {"unit": "ops"}}
    },
    {
      "id": 2,
      "title": "Records Out / sec",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
      "targets": [
        {
          "expr": "flink_taskmanager_job_task_numRecordsOutPerSecond",
          "legendFormat": "{{task_name}}"
        }
      ],
      "fieldConfig": {"defaults": {"unit": "ops"}}
    },
    {
      "id": 3,
      "title": "Watermark Lag",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
      "targets": [
        {
          "expr": "flink:watermark_lag_seconds",
          "legendFormat": "Watermark Lag"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 60},
              {"color": "red", "value": 300}
            ]
          }
        }
      }
    },
    {
      "id": 4,
      "title": "Checkpoint Duration",
      "type": "timeseries",
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8},
      "targets": [
        {
          "expr": "flink_jobmanager_job_lastCheckpointDuration",
          "legendFormat": "Last Checkpoint Duration (ms)"
        }
      ],
      "fieldConfig": {"defaults": {"unit": "ms"}}
    },
    {
      "id": 5,
      "title": "Job Restarts",
      "type": "stat",
      "gridPos": {"h": 4, "w": 8, "x": 0, "y": 16},
      "targets": [
        {
          "expr": "flink_jobmanager_job_numRestarts",
          "legendFormat": "Restarts"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 1},
              {"color": "red", "value": 5}
            ]
          }
        }
      }
    },
    {
      "id": 6,
      "title": "Backpressure Status",
      "type": "stat",
      "gridPos": {"h": 4, "w": 8, "x": 8, "y": 16},
      "targets": [
        {
          "expr": "flink_taskmanager_job_task_isBackPressured",
          "legendFormat": "{{task_name}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "mappings": [
            {"type": "value", "options": {
              "0": {"text": "OK", "color": "green"},
              "1": {"text": "BACKPRESSURED", "color": "red"}
            }}
          ]
        }
      }
    }
  ]
}
